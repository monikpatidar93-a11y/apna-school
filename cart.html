<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cart</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;margin:0;padding:0;background:#f1f3f6;}
.navbar{background:#2874f0;color:white;padding:10px 20px;display:flex;align-items:center;gap:10px;}
.navbar a{color:white;text-decoration:none;}
#cart-list{padding:20px;}
.cart-item{display:flex;gap:15px;background:white;margin:10px 0;padding:10px;border-radius:5px;align-items:center;}
.cart-item img{width:100px;height:100px;object-fit:cover;border-radius:5px;}
.qty-box{display:flex;align-items:center;gap:10px;}
.qty-box button{width:30px;height:30px;background:#2874f0;color:white;border:none;border-radius:4px;cursor:pointer;}
button.remove{background:red;color:white;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;}
h3{text-align:right;padding:10px;}
</style>
</head>
<body>
<div class="navbar">
<h2>Flipkart</h2>
<a href="index.html">Home</a>
</div>

<h2 style="text-align:center;">Your Cart</h2>
<div id="cart-list"></div>

<script>
let currentUser = JSON.parse(localStorage.getItem("currentUser"));
if(!currentUser){window.location.href="signup.html";}
let cart = JSON.parse(localStorage.getItem("cart_"+currentUser.username)) || [];
const box = document.getElementById("cart-list");

function renderCart(){
    box.innerHTML="";
    let total=0;
    cart.forEach((p,i)=>{
        total+=p.price*p.qty;
        const div = document.createElement("div");
        div.className="cart-item";
        div.innerHTML = `
            <img src="${p.image}">
            <div>
                <h4>${p.name}</h4>
                <p>₹${p.price}</p>
                <div class="qty-box">
                    <button onclick="changeQty(${i},-1)">-</button>
                    ${p.qty}
                    <button onclick="changeQty(${i},1)">+</button>
                </div>
                <button class="remove" onclick="removeItem(${i})">Remove</button>
            </div>
        `;
        box.appendChild(div);
    });
    if(cart.length>0) box.innerHTML+=`<h3>Total: ₹${total}</h3>`;
    localStorage.setItem("cart_"+currentUser.username, JSON.stringify(cart));
}

window.changeQty=(i,val)=>{
    cart[i].qty+=val;
    if(cart[i].qty<=0) cart.splice(i,1);
    renderCart();
}

window.removeItem=(i)=>{
    cart.splice(i,1);
    renderCart();
}

renderCart();
</script>
</body>
</html>