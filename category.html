<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Category</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial; margin:0; background:#f1f3f6; }
.navbar { background:#2874f0; color:white; padding:12px 20px; display:flex; align-items:center; gap:15px; }
.navbar h2 { margin:0; }
.navbar a { color:white; text-decoration:none; font-weight:bold; }
.container { max-width:1200px; margin:20px auto; }
.filters { display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; }
.filters select { padding:8px; border-radius:5px; border:1px solid #ccc; }
.products-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:20px; }
.item-card { background:white; padding:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.2); cursor:pointer; text-align:center; }
.item-card img { width:100%; height:150px; object-fit:cover; border-radius:5px; }
.item-card button { padding:5px 10px; border:none; border-radius:4px; background:#ff9f00; color:white; cursor:pointer; margin-top:5px; }
</style>
</head>
<body>

<div class="navbar">
<h2>Flipkart</h2>
<a href="index.html">Home</a>
<a href="cart.html">Cart</a>
<a href="profile.html">Profile</a>
</div>

<div class="container">
<h2>Products by Category</h2>
<div class="filters">
    <select id="categorySelect">
        <option value="">All Categories</option>
    </select>
    <select id="sortSelect">
        <option value="">Sort By</option>
        <option value="low">Price Low to High</option>
        <option value="high">Price High to Low</option>
    </select>
</div>

<div id="categoryProducts" class="products-grid"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", ()=>{
    const products = JSON.parse(localStorage.getItem("products")) || [];
    const categories = [...new Set(products.map(p=>p.category))];
    const categorySelect = document.getElementById("categorySelect");
    const sortSelect = document.getElementById("sortSelect");
    const container = document.getElementById("categoryProducts");

    categories.forEach(cat=>{
        const opt = document.createElement("option");
        opt.value = cat;
        opt.innerText = cat;
        categorySelect.appendChild(opt);
    });

    function renderProducts(list){
        container.innerHTML="";
        if(list.length===0) container.innerHTML="<p>No products found.</p>";
        list.forEach(p=>{
            const div = document.createElement("div");
            div.className="item-card";
            div.innerHTML = `
                <img src="${p.image}" alt="${p.name}">
                <h4>${p.name}</h4>
                <p>â‚¹${p.price}</p>
                <button onclick="addToCart(${p.id})">Add to Cart</button>
            `;
            div.onclick = ()=> window.location.href="product.html?id="+p.id;
            container.appendChild(div);
        });
    }

    renderProducts(products);

    categorySelect.onchange = filterAndSort;
    sortSelect.onchange = filterAndSort;

    function filterAndSort(){
        let filtered = products;
        const cat = categorySelect.value;
        if(cat) filtered = filtered.filter(p=>p.category===cat);

        const sortVal = sortSelect.value;
        if(sortVal==="low") filtered.sort((a,b)=>a.price-b.price);
        if(sortVal==="high") filtered.sort((a,b)=>b.price-a.price);

        renderProducts(filtered);
    }

    window.addToCart = function(id){
        const p = products.find(x=>x.id===id);
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const found = cart.find(x=>x.id===id);
        if(found) found.quantity+=1;
        else cart.push({...p, quantity:1});
        localStorage.setItem("cart", JSON.stringify(cart));
        alert("Added to cart ðŸ›’");
    }
});
</script>

</body>
</html>